## 標準出力ではなく標準誤りへの誤りメッセージの書き込み

現時点では、`println!`機能を使用して、すべての出力を端末に書き出しています。
ほとんどの端末は、一般情報の*標準出力*（ `stdout`）と誤りメッセージの*標準誤り*（ `stderr`）の2種類の出力を提供します。
この区別によって、ユーザーは算譜の正常な出力をファイルに指示することができますが、誤りメッセージは画面に出力されます。

`println!`機能は標準出力にしか印字できないので、標準誤りに印字するために別のものを使用する必要があります。

### 誤りが書き込まれた場所を確認する

まず、`minigrep`で印字された内容が現在標準出力に書き込まれている様子を見てみましょう。
標準的な出力ストリームをファイルにリダイレクトし、意図的に誤りが発生するようにします。
標準誤りストリームをリダイレクトしないので、標準誤りに送信された内容はすべて画面に表示され続けます。

標準出力ストリームをファイルにリダイレクトしても、命令行算譜は標準誤りストリームに誤りメッセージを送信して、画面に誤りメッセージが表示されることが予想されます。
算譜は、現在正常に動作していません。誤りメッセージの出力をファイルに保存しています。

この動作を示す方法は、標準出力ストリームをリダイレクトする`>`とファイル名*output.txt*で算譜を実行することです。
引数を渡すことはありません。誤りが発生するはずです。

```text
$ cargo run > output.txt
```

`>`構文は、標準出力の内容を画面の代わりに*output.txt*に書き込むように司得に指示します。
画面に印字されることを期待していた誤りメッセージが表示されなかったので、ファイルに終わったはずです。
これは*output.txtに*含まれています。

```text
Problem parsing arguments: not enough arguments
```

うん、誤りメッセージが標準出力に出力されています。
このような誤りメッセージが標準誤りに出力されると、正常に実行されたデータだけがファイルに格納されます。
それを変更します。

### 誤りを標準誤りに出力する

リスト12-24の譜面を使用して、誤りメッセージの出力方法を変更します。
この章の前半で行ったリファクタリングのおかげで、誤りメッセージを出力するすべての譜面が1つの機能`main`ます。
標準譜集は標準誤りストリームに出力する`eprintln!`マクロを提供していますので、代わりに`eprintln!`を使用するように`println!`を呼び出す2つの場所を変更してください。

<span class="filename">ファイル名。src / main.rs</span>

```rust,ignore
fn main() {
    let args: Vec<String> = env::args().collect();

    let config = Config::new(&args).unwrap_or_else(|err| {
        eprintln!("Problem parsing arguments: {}", err);
        process::exit(1);
    });

    if let Err(e) = minigrep::run(config) {
        eprintln!("Application error: {}", e);

        process::exit(1);
    }
}
```

<span class="caption">リスト12-24。 <code>eprintln€</code>を使って標準出力の代わりに標準誤りに誤りメッセージを書き込む</span>

`println!`を`eprintln!`変更した後、同じ方法で引数を取らずに算譜を再度実行し、`>`標準出力をリダイレクトし`>`。

```text
$ cargo run > output.txt
Problem parsing arguments: not enough arguments
```

誤りonscreenと*output.txtに*は何も含まれていません。これは命令行算譜で期待される動作です。

誤りを起こさない引き続き標準出力をファイルにリダイレクトする引数を指定して算譜を再実行してみましょう。

```text
$ cargo run to poem.txt > output.txt
```

端末に何も出力されず、*output.txt*には結果が含まれます。

<span class="filename">ファイル名。output.txt</span>

```text
Are you nobody, too?
How dreary to be somebody!
```

これは、出力の正常化のために標準出力を使用し、適切な場合には誤り出力の標準誤りを使用していることを示しています。

## 概要

この章では、これまでに学習した主な概念のいくつかを取り上げ、Rustで一般的なI / O操作を実行する方法について説明しました。
命令行引数、ファイル、環境変数、および`eprintln!`使用して誤りを印字すると、命令行譜体を作成する準備が整いました。
これまでの章の概念を使用することで、譜面は適切に整理され、適切なデータ構造に効果的にデータを格納し、誤りをうまく処理し、十分にテストされます。

次に、関数型言語の影響を受けたRustのいくつかの機能（閉包と反復子）について説明します。
